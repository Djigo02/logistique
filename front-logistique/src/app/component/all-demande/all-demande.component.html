<!--app-content open-->
<div class="main-content app-content mt-5 pt-9">
  <div class="side-app">
    <!-- CONTAINER -->
    <div class="main-container container-fluid">
      <!-- ROW-2 -->
      <div class="row">
        <div class="col-12 col-sm-12">
          <div class="card">
            <div class="card-header d-flex justify-content-between">
              <h3 class="card-title">Liste des demandes</h3>
              <!-- Select pour filtrer les demandes par statut -->
              <div class="form-group">
                <label for="statusFilter">Filtrer par statut :</label>
                <select
                  id="statusFilter"
                  class="form-control"
                  [(ngModel)]="selectedStatus"
                  (change)="filterByStatus()"
                >
                  <option value="">Tous</option>
                  <option value="en cours de traitement">En cours de traitement</option>
                  <option value="acceptee">Acceptée</option>
                  <option value="refusee">Refusée</option>
                </select>
              </div>
            </div>
            <div class="card-body pt-4">
              <div class="grid-margin">
                <div class="">
                  <div class="panel panel-primary">
                    <div class="tab-menu-heading border-0 p-0">
                      <div class="tabs-menu1">
                        <!-- Tabs -->
                        <ul class="nav panel-tabs product-sale"></ul>
                      </div>
                    </div>
                    <div class="panel-body tabs-menu-body border-0 pt-0">
                      <div class="tab-content">
                        <div class="tab-pane active" id="tab5">
                          <div class="table-responsive">
                            <table
                              id="data-table"
                              class="table table-bordered text-nowrap mb-0"
                            >
                              <thead class="border-top">
                              <tr>
                                <th
                                  class="bg-transparent border-bottom-0"
                                  style="width: 5%"
                                >
                                  Description
                                </th>
                                <th class="bg-transparent border-bottom-0">
                                  Date demande
                                </th>
                                <th class="bg-transparent border-bottom-0">
                                  Type de demande
                                </th>
                                <th class="bg-transparent border-bottom-0">
                                  Requérant
                                </th>
                                <th
                                  class="bg-transparent border-bottom-0"
                                  style="width: 10%"
                                >
                                  Statut
                                </th>
                                <th
                                  class="bg-transparent border-bottom-0"
                                  style="width: 5%"
                                  *ngIf="user.idRole == 1"
                                >
                                  Action
                                </th>
                              </tr>
                              </thead>
                              <tbody>
                              <ng-container *ngFor="let dem of filteredDemandes">
                                <tr
                                  class="border-bottom"
                                  *ngIf="user.idRole == 1 || (user.idRole == 2 && isSameCampus(dem))"
                                >
                                  <td class="text-center">
                                    <div class="mt-0 mt-sm-2 d-block">
                                      <h6 class="mb-0 fs-14 fw-semibold">
                                        {{ dem.description }}
                                      </h6>
                                    </div>
                                  </td>
                                  <td>
                                    <div class="d-flex">
                                      <div class="mt-0 mt-sm-3 d-block">
                                        <h6 class="mb-0 fs-14 fw-semibold">
                                          {{ dem.dateDemande | date: 'dd/MM/yyyy' }}
                                        </h6>
                                      </div>
                                    </div>
                                  </td>
                                  <td>
                                      <span class="fw-semibold mt-sm-2 d-block">
                                        {{ dem.objet }}
                                      </span>
                                  </td>
                                  <td>
                                      <span class="fw-semibold mt-sm-2 d-block">
                                        {{ dem.idDemandeur }}
                                      </span>
                                  </td>
                                  <td>
                                    <div class="mt-sm-1 d-block">
                                        <span
                                          class="badge bg-warning-transparent rounded-pill text-warning p-2 px-3"
                                          *ngIf="dem.statut === 'en cours de traitement'"
                                        >En cours de traitement</span>
                                      <span
                                        class="badge bg-danger-transparent rounded-pill text-danger p-2 px-3"
                                        *ngIf="dem.statut === 'refusee'"
                                      >Refusée</span>
                                      <span
                                        class="badge bg-success-transparent rounded-pill text-success p-2 px-3"
                                        *ngIf="dem.statut === 'acceptee'"
                                      >Achetée</span>
                                    </div>
                                  </td>
                                  <td *ngIf="user.idRole == 1">
                                    <div class="g-2">
                                      <a
                                        *ngIf="dem.statut != 'acceptee'"
                                        (click)="accept(dem.id)"
                                        class="btn text-primary btn-sm"
                                        data-bs-toggle="tooltip"
                                        data-bs-original-title="Accepter"
                                      >
                                        <span class="fe fe-check fs-14"></span>
                                      </a>
                                      <a
                                        (click)="refuse(dem.id)"
                                        class="btn text-danger btn-sm"
                                        data-bs-toggle="tooltip"
                                        data-bs-original-title="Refuser"
                                      >
                                        <span class="fe fe-x fs-14"></span>
                                      </a>
                                    </div>
                                  </td>
                                </tr>
                              </ng-container>
                              </tbody>
                            </table>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- ROW-2 END -->
    </div>
    <!-- CONTAINER END -->
  </div>
</div>
<!--app-content close-->
